pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
-- boi
--
function _init()
	palt(0,false)
	actors={}
	add(actors,dude(12,100,true))
	add(actors,dude(108,100))
end

function _update()
	for a in all(actors) do
		a:update()
	end
end

function _draw()
	cls()
	for a in all(actors) do
		a:draw()
	end
	rectfill(0,100,128,128,5)
end

-->8
function dude(x,y,player)
	local a={
		t=0,
		x=x,
		y=y,
		f=not player,
		n=0,
		player=player,
		update=update_dude,
		draw=draw_dude
	}
	if player then
		a.head=2
		a.chest=18
		a.arms=19
		a.weapon=20
		a.legs=34
		a.boots=50
	else
		a.head=8
		a.chest=24
		a.arms=25
		a.weapon=26
		a.legs=40
		a.boots=56
	end
	return a
end

function update_dude(a)
	if a.player then
  local still=false
		if btn(1) then
			a.x+=3
			a.t+=1
		else
			still=true
		end
		if still and a.t%12!=0 then
			if a.t%12<8 then
				a.t-=1
			elseif a.t%12>=8 then
				a.t+=1
			end
		end
		a.t%=12
		if not (btn(4) and btn(5)) then
			if not a.b4 and btn(4) then
				a.b4=true
				a.b5=false
				a.n=(a.n+1)%4
			elseif not a.b5 and btn(5) then
				a.b4=false
				a.b5=true
				a.n=(a.n+1)%4
			elseif not (btn(4) or btn(5)) then
				a.b4=false
				a.b5=false
			end
		end
	end
end

function draw_dude(a)
	local x=a.x
	local y=a.y-7+abs(a.t%11-6)
	local f=a.f
	local ff=f and -8 or 8
	spr(a.head,x,y-28,1,1,f)
	spr(a.chest,x,y-20,1,1,f)
	if a.t%12>1 and a.t%12<9 then
		spr(a.legs+1,x,y-12,1,1,f)
		spr(a.boots-1,x-ff,y-12,1,1,f)
		spr(a.boots+1,x+ff,y-12,1,1,f)
	else
		spr(a.legs,x,y-12,1,1,f)
		spr(a.boots,x,y-4,1,1,f)
	end
	local fx=f and -8 or 8
	spr(a.arms-2,x-fx,y-20,1,1,f)
	if a.n==1 then
		spr(a.arms-3,x+fx,y-25,1,1,not f,true)
		spr(a.weapon+16,x+fx*1.125,y-40,1,2,f,true)
	elseif a.n==3 then
		spr(a.arms-2,x+fx,y-20,1,1,not f)
		spr(a.weapon+16,x+fx,y-12,1,2,f)
	else
		spr(a.arms,x+fx,y-20,1,1,f)
		if f then
			fx=fx*2-8
		else
			fx*=2
		end
		spr(a.weapon,x+fx,y-20,2,1,f)
	end
end
-->8
width={
	[20]=1,
	[26]=2
}
__gfx__
00000000000000000444444404444444000000000000000000000000000000000999999900000000000000000000000000000000000000000000000000000000
00000000000000004400400416111611000000000000000000000000000000009900900900000000000000000000000000000000000000000000000000000000
00700700000000004400400441614161000000000000000000000000000000009900900900000000000000000000000000000000000000000000000000000000
00077000000000004444444444444444000000000000000000000000000000009999999900000000000000000000000000000000000000000000000000000000
00077000000000004444444444444444000000000000000000000000000000009000000900000000000000000000000000000000000000000000000000000000
00700700000000004090909040909090000000000000000000000000000000009000000900000000000000000000000000000000000000000000000000000000
00000000000000000409090904090909000000000000000000000000000000009099990900000000000000000000000000000000000000000000000000000000
00000000000000000044444400444444000000000000000000000000000000009990099900000000000000000000000000000000000000000000000000000000
00004440000000000000000000000000000000000000000000004440000000000000000000000000090000000000000000000000000000000000000000000000
00044440000004404400004404440000040000000000000000044440000004406600006604440000096666666666666000000000000000000000000000000000
00044440000044404440044404444444046666666660000000044440000044406660066604444464090000000000000600000000000000000000000000000000
00044000000044404444444404444444046666666600000000044000000044406666666604444464096666666666666000000000000000000000000000000000
00044000000044400444444000000000040000000000000000044000000044400666666000000000090000000000000000000000000000000000000000000000
00044000000004400444444000000000000000000000000000066000000004400666666000000000000000000000000000000000000000000000000000000000
00044000000004400444444000000000000000000000000000044000000006600666666000000000000000000000000000000000000000000000000000000000
00000000000004400444444000000000000000000000000000000000000004400666666000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000444994004449940044440000000000000000000000000000444994004449940999990000000000000000000000000000000000000000000
00000000000000000666666006666660006600000000000000000000000000000cccccc00cccccc0060600000000000000000000000000000000000000000000
00000000000000000666666066666666006600000000000000000000000000000cccccc0cccccccc060600000000000000000000000000000000000000000000
00000000000000000666066066666666006600000000000000000000000000000ccc0cc0cccccccc060600000000000000000000000000000000000000000000
00000000000000000666066000000000006600000000000000000000000000000ccc0cc000000000060600000000000000000000000000000000000000000000
00000000000000000666066000000000006600000000000000000000000000000ccc0cc000000000060600000000000000000000000000000000000000000000
00000000000000000660066000000000006600000000000000000000000000000cc00cc000000000060600000000000000000000000000000000000000000000
00000000000000000000000000000000006600000000000000000000000000000000000000000000060600000000000000000000000000000000000000000000
00000000000000000440044000000000006600000000000000000000000000000660066000000000060600000000000000000000000000000000000000000000
00000000000000000440044000440000006000000000000000000000000000000660066000660000060600000000000000000000000000000000000000000000
00000000000044440444044444440000000000000000000000000000000066660666066666660000060600000000000000000000000000000000000000000000
00000000000044440444044444440000000000000000000000000000000066660666066666660000060600000000000000000000000000000000000000000000
00000000000044000000000000000000000000000000000000000000000066000000000000000000060600000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000060600000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000
