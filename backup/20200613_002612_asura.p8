pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
-- asura
--
function _init()
	rumble=0
	plx,ply=0,110
	charge=0
	camx,camy=viewport(plx,ply)
end

function viewport(x,y)
	x=min(max(x-60,-512),384)
	y=min(y-8,100)
	return x,y
end

function _update()
	rumble=max(rumble-1,0)
	power,bolty=move_bolt(power,bolty)
end

function move_bolt(v,y)
	if v then
			y-=1
			v-=10
			if v<=0 then
				v=nil
			end
		end
	end
	return v,y
end

function _draw()
	cls(13)
	shake(camx,camy)
	draw_background(camx)
	draw_charge(charge,plx,ply)
	draw_ground()
	draw_shadow(plx,ply)
	draw_bolt(power,boltx,bolty)
end

function shake(x,y)
	if rumble>0 then
		x+=rnd(2)
		y+=rnd(2)
	end
	camera(x,y)
end

function draw_background(x)
	map(0,16,-512+x/3,136,128,8)
end

function draw_charge(v,x,y)
	if v>0 then
		v=flr(v/80)
		circfill(x+4,y+3,v+3,0)
		circ(x+4,y+3,v+3,10)
	end
end

function draw_ground()
	rectfill(-512,199,512,200,0)
	rectfill(-512,200,512,232,4)
	line(-512,200,512,200,11)
	map(0,0,-512,136,128,16)
end

function draw_shadow(x,y)
	if y>189 then
		spr(16,x,392-y)
	end
end

function draw_bolt(v,x,y)
	if v then
		local c=bolt_color(v)
		v=flr(v/50)
		x,y=x+3,y+3
		rectfill(x-v,0,x+v,200,c)
		rectfill(-512,y-v,512,y+v,c)
	end
end

function bolt_color(v)
	if v<=100 then
		return 0
	elseif <=200 then
		return 6
	elseif <=300 then
		return 7
	else
		return 10
	end
end


-- function _deva(x,y)
-- 	return{
-- 		x=x,
-- 		y=y,
-- 		dx=0,
-- 		dy=0,
-- 		flap=0,
-- 		fly=true,
-- 		charge=0,
-- 		-- deva:input
-- 		input=function(a)
-- 			local speed=a.fly and 4 or 3
-- 			if(btn(0))a.dx=-speed
-- 			if(btn(1))a.dx=speed
-- 			if(btn(0) and btn(1))a.dx=0
-- 			if btn(4) and a.flap<=0 then
-- 				a.flap=1
-- 				a.dy=-14
-- 			elseif not btn(4) and a.dy>=-3 then
-- 				a.flap-=1
-- 			end
-- 			if btn(5) then
-- 				a.charge+=20
-- 				a.charge=min(a.charge,500)
-- 			end
-- 		end,
-- 		-- deva:update
-- 		update=function(a)
-- 			a.x+=a.dx
-- 			a.y+=a.dy
-- 			a.dy=a.dy+abs(a.y*0.01)
-- 			a.dx*=0.777
-- 			a.dy*=0.777
-- 			a.x=min(max(a.x,-514),507)
-- 			a.y=min(max(a.y,50),192)
-- 			a.fly=a.y<190
-- 			if not btn(5) and a.charge>=500 then
-- 				local x,y=a.x,a.y
-- 				add(actors,_bolt(x,y,a.charge))
-- 				a.charge=0
-- 				rumble:set(9)
-- 			elseif not btn(5) then
-- 				a.charge-=20
-- 				a.charge=max(a.charge,0)
-- 			end
-- 		end,
-- 		-- deva:draw
-- 		draw=function(a)
-- 			local x,y=a.x,a.y
-- 			-- deva wings
-- 			local fx,fy=flr(a.dx/2),flr(a.dy/2)
-- 			local f=max(a.flap,-2)
-- 			if y<180 then
-- 				if a.dy<4 then
-- 					rectfill(x+2,y-4,x+5,y-2,0)
-- 					rect(x+2,y-4,x+5,y-2,10)
-- 				end
-- 				if	a.flap>-5 then
-- 					spr(max(2+f,0),x-8,y-fx-fy,1,1,1)
-- 					spr(max(2+f,0),x+8,y+fx-fy)
-- 				end
-- 			end
-- 			-- deva body
-- 			local flip=not btn(0) and btn(1)
-- 			if not btn(0) and not btn(1) then
-- 				spr(4,x,y)
-- 			elseif not a.fly then
-- 				f=flr(gt/4%2)
-- 				fy=flr(gt/7%2)
-- 				spr(6+f,x,y-fy,1,1,flip)
-- 			else
-- 				spr(5,x,y,1,1,flip)
-- 			end
-- 		end
-- 	}
-- end
__gfx__
0000000000000000000000000000000000ffff000ffff0000ffff0000ffff0000000000000000000000000000000000000000000000000000000004005555550
060060007777770077777770aaaa000000ffff000ffff0000ffff0000ffff0000000000000000000000000000000000000000000000000000077774007777755
006600007777777077777777aaaaa00077ffff777ffff7777ffff7777ffff7770000000000000000000000000000000000000000000000000777774071171175
0066000007777700077777770aaaaa007777f777777f7777777f7777777f77770000000000000000000000000000000000000000000000007766664071171175
06006000007700000077077700aaaa00777797777779777077797770777977700000000000000000000000000000000000000000000000007600004077717775
000000000000000000000077000aaa00077797700779777007797770077977700000000000000000000000000000000000000000000000006000004055777555
000000000000000000000000000aaaa0009999000099990000999900009999000000000000000000000000000000000000000000000000000000004005555555
0000000000000000000000000000aaa000aaaa00000aaa0000aa00000000aa000000000000000000000000000000000000000000000000000000004005565555
05555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004055666555
05555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004055565555
00555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004005666555
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004005565550
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000555500
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000555000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000555000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000055000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004444444444444444444444444444444444444444000000000000000000000000000000001111111144bbbbbb2bbbbbb40000000b00000000
0000000000000000444455444444444444444444444444444444444400000000111111111000000000000001111111114454545454545444000000b3b0000000
000000000000000044455544455444444444444444444444444545440000000011111111110000000000001111111111444545454545444400000b343b000000
00000000000000004445554445554444444545444444444444444444000000001111111111100000000001111111111144444444545444440000b33433b00000
0000000000660000444444444555444444445454445444444454544400000000111111111111000000001115111111114444444444444444000b033b330b0000
0066660006666000444444444444444444454544444544444444444400000000111111111111100000011511111111114444444444444444000003b3b3000000
066666600666660044444444444444444444545444444444444444440000000011111111111111000011111111111111444444444444444400000b343b000000
06666660066666604444444444444444444444444444444444444444000000001111111111111110011151511111111144444444444444440000b34443b00000
4444444446666dd44d6666d455555455000000000000000000000000000000000000000000000000000000000000000044bbbb22bbb22244000b334b433b0000
444444444dddd44444dddd44444444440000000000000000000000000000000000000000000000000000000000000000444454545454444400b333b3b333b000
44444444444444444454545444444444000000000000000000000000000000000000000000000000000000000000000044454545454444440b003b343b300b00
44444444444444444445454444444444000000000000000000000000000000000000000000000000000000000000000044445454444444440000b33433b00000
4444444444444444444444444444444400000000000000000000000000000000000000000000000000000000000000004444444444444444000b333b333b0000
444444444444444444444444444444440000000000000000000000000000000000000000000000000000000000000000444444444444444400b303b3b303b000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000044444444444444440b000b343b000b00
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000044444444444444440000b34443b00000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004455522222222224000b334b433b0000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000444454545454444400b333b3b333b000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444545454544440b003b343b300b00
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444545444440000b33433b00000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004444444444444444000b333b333b0000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000444444444444444400b303b3b303b000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444444444440b000b323b000b00
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444444444440000b32223b00000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044555222222224540000002220000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044445454545444440000002220000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444545454444440000004420000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444454444444440000004440000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444444444440000004440000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444444444440000004440000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444444444440000004440000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444444444440000044444000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000004e4f000000000000000000000000000000000000000000004e4f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004e4f00000000000000000000000000000000004e4f0000
000000004e4f0000000000000000000000004e4f005e5f0000000000004e4f000000000000000000004e4f00005e5f004e4f00000000000000004e4f000000000000000000000000000000004e4f000000000000000000004e4f00000000000000000000004e4f00005e5f000000000000000000004e4f00000000005e5f0000
000000005e5f004e4f00004e4f00000000005e5f005e5f00004e4f00005e5f004e4f000000004e4f005e5f00005e5f005e5f00004e4f004e4f005e5f000000004e4f0000004e4f00000000005e5f00004e4f0000004e4f005e5f4e4f00004e4f0000004e4f5e5f00005e5f00004e4f00004e4f00005e5f00004e4f005e5f0000
000000005e5f005e5f00005e5f00000000005e5f005e5f00005e5f00005e5f005e5f000000005e5f005e5f00005e5f005e5f00005e5f005e5f005e5f000000005e5f0000005e5f00000000005e5f00005e5f0000005e5f005e5f5e5f00005e5f0000005e5f5e5f00005e5f00005e5f00005e5f00005e5f00005e5f005e5f0000
000000006e6f006e6f00006e6f00000000006e6f006e6f00006e6f00006e6f006e6f000000006e6f006e6f00006e6f006e6f00006e6f006e6f006e6f000000006e6f0000006e6f00000000006e6f00006e6f0000006e6f006e6f6e6f00006e6f0000006e6f6e6f00006e6f00006e6f00006e6f00006e6f00006e6f006e6f0000
000000007e7f007e7f00007e7f40000041007e7f007e7f00407e7f41007e7f007e7f400000007e7f007e7f00417e7f007e7f00407e7f007e7f007e7f004100007e7f0040007e7f00004100007e7f00407e7f0000007e7f417e7f7e7f00007e7f0000407e7f7e7f00417e7f40007e7f00007e7f41007e7f40007e7f417e7f4000
000000507c7d534c4d00007c7d52505051004c4d536c6d50515c5d52506c6d537c7d525000004c4d004c4d00525c5d504c4d00516c6d534c4d004c4d005100537c7d5052004c4d00505200004c4d00516c6d0053537c7d515c5d6c6d53004c4d5050527c7d4c4d00517c7d51506c6d50004c4d52505c5d52504c4d517c7d5200
0000000045000000000000000000004400004600000000450000000000000000460000004400000000000000000045000000000000000000000044000000000046000000000000000000000000450000000000000000000000000000000000004400004500000000000000004400000000004400000000004600004500000044
0000000000460000000042000000000000450000000000000000004500000000004500000000450000000045000000000000450000000000000000000046004500000000450000450000004400000000450000000000440000000043004500000000000000000045000000000046000000420000000045000000000000000000
0000004300000000440000000045000000000000460000000046000000440000000000460000000042000000000000000046000000004400000000004300000046000000000000000000430000460000000042000000004500000000000000000000000046004300000046000000000000000000000000000044000000430000
0046000000004400000000004600000000004400000045000000430000000000000044000045000000000046004400004300000045000000464400000000000000004400000044004600000000004400004600004400000000440000000046004200004400000000000000440000004300000045004400450000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000004a48490000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000004a484848490000000000000000000000000000000000000000004a4b4b4b4849000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004a484b4b4b4b4b484848484900000000000000000000000000004a484b4b4b4b4b4b4900000000000000000000000000000000000000000000000000004a484848484848490000000000004a48484848490000000000000000000000000000000000000000004a4848490000000000000000004a4849000000000000
00004a484b4b4b4b4b4b4b4b4b4b4b4b49000000000000000000004a48484b4b4b4b4b4b4b4b4b4900000000000000004a4848484848490000000000004a4848484b4b4b4b4b4b4b4b000000004a484b4b4b4b4b4b4848484848484849000000000000004a48484848484b4b4b4b484848484848494a484b4b4b484849000000
48484b4b4b4b4b4b4b4b4b4b4b4b4b4b4b48490000000000004a484b4b4b4b4b4b4b4b4b4b4b4b4b484900000000004a4b4b4b4b4b4b4b48484900004a4b4b4b4b4b4b4b4b4b4b4b4b000000004b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b484900000000004b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b484848
4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b490000004a484b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4900004a484b4b4b4b4b4b4b4b4b4b4b48484b4b4b4b4b4b4b4b4b4b4b4b4b4900004a4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b490000004a4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b
4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4848484b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b48484b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b00004b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4900004b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b4b
