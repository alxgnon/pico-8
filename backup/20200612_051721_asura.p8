pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
-- asura
--
-->8
-- deva
function _deva(x,y,ctrl)
	return{
		x=x,y=y,
		dx=0,dy=0,
		flap=0,
		control=function(a)
			if(btn(0))a.dx=-3
			if(btn(1))a.dx=3
			if btn(4) and a.flap==0 then
				a.flap=1
				a.dy=-14
			elseif not btn(4) and a.dy>=-3 then
				a.flap=0
			end
		end,
		update=function(a)
			a.x=a.x+a.dx
			a.y=max(a.y+a.dy,8)
			a.dy=a.dy+abs(a.y*0.01)
			a.dx*=0.777
			a.dy*=0.777
		end,
		draw=function(a)
			local f=abs(a.flap)
			local x,y=a.x,a.y
			local dx,dy=a.dx,a.dy
			rectfill(x+2,y-5,x+5,y-2,0)
			rect(x+2,y-5,x+5,y-2,10)
			spr(2+f,x-8,y-dx/2-dy/2,1,1,true)
			spr(2+f,x+8,y+dx/2-dy/2)
			spr(1,x,y)
		end
	}
end
-->8

-->8
-- init
function _init()
	actors={}
	pl=_deva(60,16,true)
	add(actors,pl)
end

-- update
function _update()
	for a in all(actors) do
		if a==pl then
			a:control()
		end
		a:update()
	end
end

-- draw
function _draw()
	cls(13)
	for a in all(actors) do
		a:draw()
	end
	draw_mana_bar()
end

-- draw mana bar
function draw_mana_bar()
	rectfill(118,9,125,39,0)
 rect(118,9,125,39,10)
	spr(4,118,2,1,1,false,true)
	spr(4,118,39)
end
__gfx__
00000000a066660a0000000000000000aaaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000070ffff0777777770777700000aaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070077ffff777777777777777000000aa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770007777f7770777777707777700000aa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700077776777007707770077770000aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070007776770000000770007770000aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006666000000000000077770000aa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000aaaa000000000000007770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
