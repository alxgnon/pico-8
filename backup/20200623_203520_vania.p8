pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
-- vania
--
function _init()
	palt(0,false)
	palt(1,true)
	world.make()
end

function _update()
	pl.update()
	world.update()
end

function _draw()
	cls()
	cam.draw()
	world.draw()
	pl.draw()
end

-- world
world={
	make=function()
		room={}
		for i=1,32 do
			room[i]={}
		end
		_b(1,5)
		world.load(1,6)
	end,
	update=function()
	end,
	load=function(x,y)
		x,y=flr(x),flr(y)
		if room[x] and room[x][y] then
			r=room[x][y]
			if(r.l)r.l()
		end
	end,
	draw=function()
		map(r.j,r.i,r.x*128,r.y*128,r.w,r.h)
	end
}

-- room layouts
function _r(x,y,j,i,w,h,l)
	return{j=j,i=i,x=x,y=y,w=w,h=h,l}
end

function _b(x,y,l)
	local r=_r(x,y,0,0,48,32,l)
	room[x][y]=r
	room[x][y+1]=r
	room[x][y+2]=r
	room[x+1][y]=r
	room[x+1][y+1]=r
	room[x+1][y+2]=r
end
-->8
-- player
--
pl={
	x=182,
	y=800,
	f=0,
	update=function()
		anim_facing()
		if not pl.halt then
			local dx,dy,moved=arrows(2.625)
			if moved then
				pl.x+=dx
				--pl.y+=dy
			end
		end
	end,
	draw=function()
		local x,y=pl.x,pl.y
		local f=pl.f
		if f<8 and f>-8 then
			spr(128,x,y,1,4)
			spr(146,x+8,y+8,1,2)
			spr(146,x-1,y+8)
		elseif f>0 then
			spr(129,x,y,1,2)
			spr(161,x,y+16,1,2)
			spr(146,x+8,y+8,1,2)
			spr(146,x-1,y+8)
		else
			spr(129,x,y,1,2,true)
			spr(161,x,y+16,1,2,true)
			spr(146,x+1,y+8,1,2,true)
			spr(146,x-1,y+8)
		end
		if f<4 then
			spr(178,x-16,y+16,2,1,true)
		else
			spr(178,x-1,y+16,2,1)
		end
	end
}

-- input
function arrows(mult)
	local dx,dy=0,0
	if(btn"0")dx-=mult
	if(btn"1")dx+=mult
	if(btn"2")dy-=mult
	if(btn"3")dy+=mult
	return dx,dy,dx!=0 or dy!=0
end

-- animation
function anim_facing()
	pl.halt=btn"0" and btn"1"
	if pl.halt then
		pl.f=0
	else
		if btn"0" then
			pl.f=max(pl.f-1,-8)
		elseif btn"1" then
			pl.f=min(pl.f+1,8)
		end
	end
end

-- camera
cam={
	x=128,
	y=768,
	update=function()
	end,
	draw=function()
		camera(cam.x,cam.y)
	end
}


__gfx__
11111111665566661111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111666566661111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11711711666556661111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11177111555555551111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11177111566666651111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11711711666666651111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111666666551111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111555555551111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11666611116666111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
16665661166665611111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
6665f56666665f561111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
555fff555555fff51111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
ff28f28ffff28f281111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
ffffffffffffffff1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1ffffff11ffffff11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11ffff1111ffff111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
99000099999000091111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
55900955555900959111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
55999955555999955111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
55955955555955955111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
15955951155955915111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
15955951155955915111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
15955951155955919111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
15955951155955915111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1006600110006601ff11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1999999119999991ff11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1555555115555551ff11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
15555551155555511111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
15550551155505511111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
15550551155505511111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
15950591155905911111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
19990991159909911111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1555055115550551ff0c111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1555055115550551ff0c666666666661111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1999099119990991ff0c666666666661111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1444044114440441111c111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
14440441144404411111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
14440441144404411111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
44440444144444441111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111113311111331311111113111112221111133111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111138831113883831111137311124442111388311
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111380873113288831111377731124421111366311
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111388873113828231113773311124421113633631
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111137731113822831137731111128211113633631
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111113311113828311377311111128111111366311
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111113333111137311111112111111133111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111113111111111111111111111
__map__
0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010000000000000101010101
0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010000000000000101010101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000101
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000101
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000101
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000101
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000101
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010000000000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000101
0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010100000000000001010101010101010101010101010101010101010101010101010101010101010101010101
0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010100000000000001010101010101010101010101010101010101010101010101010101010101010101010101
